<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symbol Detector Test Page</title>
</head>
<body>
    <div id="test-container">
        <h1>Test Symbols</h1>
        <div id="test-1">
            <p><span>NVDA</span></p>
            <p><span>MSFT</span></p>
            <p><span>GOOGL</span></p>
        </div>
        <div id="test-2">
            <p><span>AAPL</span></p>
            <p><span>TSLA</span></p>
            <p><span>AMZN</span></p>
        </div>
        <div id="test-3">
            <p><span>BRKB</span> <span>BFA</span></p>
        </div>
        <div id="test-4" style="display: none;">
            <p><span>AAPL</span></p>
            <p><span>TSLA</span></p>
            <p><span>NVDA</span></p>
        </div>
    </div>
    
    <div id="dynamic-root"></div>
    
    <script>
        // Expose test helpers
        window.testHelpers = {
            getSymbolCount: () => {
                const badges = document.querySelectorAll('.symbol-badge');
                const symbols = new Set();
                badges.forEach(badge => {
                    const symbol = badge.getAttribute('data-symbol');
                    if (symbol) symbols.add(symbol);
                });
                return symbols.size;
            },
            getBadgeCount: () => document.querySelectorAll('.symbol-badge').length,
            getGroupCount: (symbol) => {
                const badges = document.querySelectorAll(`.symbol-badge[data-symbol="${symbol}"]`);
                if (badges.length === 0) return 0;
                return badges[0].querySelectorAll('.symbol-group').length;
            },
            hasTooltip: (symbol) => {
                const badges = document.querySelectorAll(`.symbol-badge[data-symbol="${symbol}"]`);
                if (badges.length === 0) return false;
                return !!badges[0].querySelector('.symbol-tooltip');
            },
            getCategoryLinkCount: (symbol) => {
                const badges = document.querySelectorAll(`.symbol-badge[data-symbol="${symbol}"]`);
                if (badges.length === 0) return 0;
                const tooltip = badges[0].querySelector('.symbol-tooltip');
                if (!tooltip) return 0;
                return tooltip.querySelectorAll('a[href]').length;
            },
            addDynamicContent: () => {
                const root = document.getElementById('dynamic-root');
                root.innerHTML = `
                    <div class="card">
                        <h3>Stock Analysis</h3>
                        <div class="content">
                            <p><span>AMZN</span></p>
                            <p><span>GOOGL</span></p>
                        </div>
                    </div>
                `;
            },
            clearBadges: () => {
                document.querySelectorAll('.symbol-badge').forEach(badge => badge.remove());
            }
        };
    </script>
</body>
</html>
